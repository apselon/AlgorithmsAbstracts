\section{Паросочетания. Минимальное вершинное покрытие.}%
\label{sec:1. Паросочетания. Минимальное вершинное покрытие.}

\begin{Def}
	\textbf{Двудольный граф} -- граф, множество вершин которого можно разбить на две части таким образом, что каждое ребро графа соединяет какую-то вершину из одной части с какой-то вершиной другой части, то есть не существует рёбер между вершинами одной и той же части.
\end{Def}

\begin{Def}
	\textbf{Хроматическое число} -- минимальное число цветов, в которые можно раскрасить вершины графа так, чтобы концы любого ребра имели разные цвета.
\end{Def}

\begin{Def}
	\textbf{Паросочетание} (англ. matсhing) в двудольном графе — произвольное множество рёбер двудольного графа, такое что никакие два ребра не имеют общей вершины.\\
	\textbf{Мощность паросочетания} -- количество ребер в нем.\\
	\textbf{Максимальное паросочетание} -- мощность которого \textit{наибольшая} среди всех возможных паросочетаний в данном графе.
\end{Def}

\begin{Def}
	\textbf{Цепь} -- некоторый простой путь (т.е. не содержащий повторяющихся вершин или рёбер).\\
	\textbf{Чередующаяся цепь} -- цепь, в которой рёбра поочередно принадлежат/не принадлежат паросочетанию.\\
	\textbf{Увеличивающая цепь} -- чередующаяся цепь, в которой начальная и конечная вершины \textit{НЕ} принадлежат паросочетанию.\\
	\textbf{Уменьшающая цепь} -- цепь, в которой начальное и конечное ребра принадлежат паросочетанию.
\end{Def}

\begin{Def}
	Вершины двудольного графа, инцидентные рёбрам паросочетания M, называются \textbf{насыщенными} или покрытыми. \\
\end{Def}

\subsection*{Алгоритм Куна.}%
\label{sub:Алгоритм Куна.}

\begin{theorem}
	(Бержа) Паросочетание $M$ в двудольном графе  $G$ -- max $\iff $ в $G$ нет увеличивающей цепи относительно $M$.
\end{theorem}

\begin{proof} \ \\
	 $\Rightarrow$: \\
		От противного: Пусть в $G$ с максимальным паросочетанием $M$ существует увеличивающая цепь. \\
		Тогда заменив в ней все рёбра, входящие в паросочетание, на невходящие и наоборот, мы получим большее паросочетание.\\
		То есть $M$ не являлось максимальным. Противоречие.\\
	$\Leftarrow$: \\
	 	Пусть $M$ -- не max, покажем что $\exists$ увеличивающая цепь.\\
		Пусть $M'$ -- паросочетание: $\lvert M' \rvert > \lvert M \rvert $\\
		Построим подграф  $G' = M \bigoplus M'$, состоящий из ребер $\in$ только одному из паросочетаний.\\
		$M$ и  $M'$ -- паросочетания  $\Rightarrow$ нет вершин, которые смежны с двумя ребрами из паросочетания. То есть у каждой вершины подграфа есть не более одного ребра из $M$ и не более одного из  $M'$.  $\Rightarrow \forall v \in G' \hookrightarrow deg(v) \leq 2$\\
		Как известно, графы с таким свойством степеней вершин предстваляют из себя наборы цепей и циклов. \\
		При этом длина цикла должна быть четной, ведь иначе мы будем иметь вершину, у которой два ребра, к ней смежных, принадлежат одному паросочетанию.\\
		В циклах поровну ребер из каждого паросочетания, значит их вклад в отрыв $M'$ от $M$ по числу ребер -- нулевой.\\
		Значит обогнать $M$ у  $M'$ получится только если в графе имеется цепочка нечетной длины, у которой начальное и конечное ребра лежат в $M'$. Вот эта вот цепочка и есть увеличивающая.
\end{proof}

\subsection{Алгоритм Куна для поиска максимального паросочетания.}
\begin{enumerate}
	\item Фиксируем доли графа: L и R. Изначально считаем паросочетание пустым. 
	\item В доле L перебираем вершины в порядке увеличения номеров.
	\item Если вершина насыщена, то пропускаем ее и идем дальше.
В противном случае, пытаемся насытить вершину, запустив поиск увеличивающей цепи из этой вершины следующим образом: 
	\begin{enumerate}
		\item Стоя в текущей вершине $v$ доли L, просмотрим все ребра из этой вершины.
		\item Возьмем текущее ребро $(v, t_0)$: 
Если $t_0$ -- ненасыщена, то одно ребро $(v, t_0)$ и задает нам увеличивающую цепь, просто увеличим паросочетание с его помощью и прекратим поиск.
Если же $t_0$ насыщена каким-то ребром  $(t_0, p)$, то пойдем вдоль этого ребра, уже в поисках увеличивающейся цепи, проходящей через ребра $(v, t_0)$ и  $(t_0, p)$. Для этого просто перейдем в вершину p и продолжим обход из нее.
	\end{enumerate}
\item В конечном итоге, мы либо найдем увеличивающую цепь из вершины $v$ и увеличим паросочетание этой цепью, тем самым насытив вершину, либо же покажем отсутствие увеличивающей цепи и невозможность насыщения вершины.
\item Возьмем следующую по порядку вершину доли L и повторим.
\item После того как мы просмотрим все вершины, пытаясь увеличить паросочетание цепью из них, мы получим максимальное паросочетание.
\end{enumerate}
Разумеется, асимптотика алгоритма будет $O(n^3)$, ведь это $n$ применений $DFS$. 
\par
Докажем корректность алгоритма. Она следует из теоремы Бержа и того факта, что если из вершины $x$ не существует дополняющей цепи относительно паросочетания $M$ и паросочетание $M'$ получается из $M$ изменением вдоль дополняющей цепи, тогда из $x$ не существует дополняющей цепи в $M'$. \href{http://gg.gg/njb4g}{Доказтельство.} (http://gg.gg/njb4g)

\subsection*{Минимальное вершинное покрытие.}%
\label{sub:Минимальное вершинное покрытие.}

\begin{Def}
	\textbf{Вершинное покрытие} графа G=(V,E)  - такое подмножество S множества вершин графа V, что любое ребро этого графа инцидентно хотя бы одной вершине из множества S.
\end{Def}

\begin{Def}
	\textbf{Минимальное вершинное покрытие} графа -- вершинное покрытие, состоящие из \textit{наименьшего} числа вершин.
\end{Def}

\begin{prop}
	$\lvert M_{max} \rvert \leq \lvert C_{min} \rvert$.
	Чтобы покрыть все ребра, нам нужно вершин не меньше, чем мощность наибольшего паросочетания.
\end{prop}

\begin{proof} \ \\
	Паросочетание это, как известно, набор непересекающихся рёбер. Мы хотим взять набор вершин, эти ребра покрывающий. Ясно что каждая вершина может покрыть не более одного ребра, ведь они не пересекаются по концам. Оценка снизу доказана.
\end{proof}

\begin{theorem} (Кёнига) \\
	В двудольном графе $\lvert M_{max} \rvert = \lvert C_{min} \rvert$.
\end{theorem}

\begin{proof} 
	Явно предъявим покрытие, размер которого равен размеру максимального паросочетания.
	\begin{enumerate}
		\item Разделим граф на доли L и R.
		\item Сориентируем ребра: Из $M_{max} \longleftarrow$, остальные $\longrightarrow$
		\item Обойдем граф из \textit{ненасыщенных паросочетанием} вершин $\in$ L.
		\item Получим разбиение графа на четыре множества: 
		$L^+, R^+$ -- вершины, лежащие в L или R соответственно, которые доступны из ненасыщенных вершин, лежащих в L. 
		$L^-, R ^-$ -- аналогично \textit{недоступные} из ненасыщенных вершин, лежащих в L. 
		\item Поймем какие ребра бывают между каждыми из четырех множеств:
		\begin{enumerate}
			\item Покажем, что ребер $L^+ \rightarrow R^-$ не бывает, ведь если бы такое ребро имелось, мы из достижимой вершины, лежащей в $L^+$ добрались бы по этому ребру до вершины, по определению $R^-$, недостижимой. 
			\item Из аналогичных рассуждений понятно что не бывает ребер $R^+ \rightarrow L^-$.
			\item Покажем отсутствие ребер $R^- \rightarrow L^+$:
		От противного: Пусть  $(r^-, l^+)$ -- такое ребро. Это ребро вида  $\longleftarrow$, то есть принадлежащее паросочетанию.\\
		Вершина $l^+$ -- насыщена, значит чтобы до нее дойти мы должны были начать обход из какой-то другой вершины  $l'$, из которой $l^+$ достижима ($l^+$ не может быть "началом" обхода, поскольку она насыщена).\\
		Так как  $l'$ и $l^+$ лежать в одной доле двудольного графа, маршрут из $l'$ в $l^+$ в какой-то момент должен пойти справа налево, то есть имеется ребро вида $(r', l^+)$, которое в силу своего направления также лежит в паросочетании. Значит из смежные ребра  $(r^-, l^+)$ и  $(r', l^+)$ лежат в одном паросочетании. Противоречие.\\
		\end{enumerate}
		\item Получаем что любое ребро графа инцидентно или вершине из $L^-$ или вершине из $R^+ \Rightarrow L^- \cup R^+$ -- вершинное покрытие.
		\item Покажем, что все вершины из $L^- \cup R^+$ насыщены ребрами из паросочетания:\\
		Это так, ведь если бы были ненасыщенные вершины в L-, то мы бы запускали из них обход, и они автоматически стали бы L+ (так как вершина достижима сама из себя, а обход мы запускаем из всех ненасыщенных левых вершин). В свою очередь, если бы в $R^+$ была ненасыщенная вершина, то существовала бы увеличивающая цепь, в этой вершине заканчивающаяся, что противоречит максимальности паросочетания.\\
		\item Как было показано ранее, не существует ребер $R^+ \rightarrow L^-$, поэтому каждому ребру паросочетания инцидентна ровно одна вершина покрытия $L^- \cup R^+$. Тогда по приведенной выше оценке мы можем сделать вывод, что требуемое покрытие найдено.
	\end{enumerate}
\end{proof}
